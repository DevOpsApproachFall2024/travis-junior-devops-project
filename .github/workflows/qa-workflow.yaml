name: QA Workflow

on:
    pull_request:
        branches:
            - main

jobs:
    frontend:
        runs-on: self-hosted

        steps:
            -
                name: Checkout
                uses: actions/checkout@v4
            
            - 
                name: Setup Node
                uses: actions/setup-node@v2
                with:
                    node-version: '20'
            - 
                name: Move to frontend directory
                run: cd frontend
            
            - 
                name: Install Dependencies
                run: npm install

            -
                name: Run Linter
                run: npm run lint
            -
                name: Run Tests
                run: npm run test-headless
            - 
                name: Test Build
                run: npm run build --prod
            
    backend:
        runs-on: self-hosted

        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Setup Java
              uses: actions/setup-java@v2
              with:
                  java-version: '17'

            - name: Move to backend directory
              run: cd backend

            - name: Install Dependencies
              run: ./mvnw clean install

            - name: Run Linter (Checkstyle)
              run: ./mvnw checkstyle:check

            - name: Run Tests
              run: ./mvnw test

            - name: Build
              run: ./mvnw package